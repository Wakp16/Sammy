:root {
  --pink: #ff4fa3;
  --glass: rgba(20, 20, 20, 0.65);
}

* { box-sizing: border-box; font-family: system-ui, sans-serif; }
html { scroll-behavior: smooth; }
body { margin:0; min-height:100vh; display:flex; justify-content:center; align-items:center; color:white; overflow:hidden; background:#111; }
.hidden { display:none !important; }
.view { animation: viewIn 220ms ease; }
@keyframes viewIn { from { opacity:0; transform: translateY(6px); } to { opacity:1; transform: translateY(0); } }

/* Background: replaced image texture with a code-themed animated canvas */
/* The canvas element (#bgCanvas) sits under the app and renders animated code/hearts. */
#bgCanvas { position:fixed; inset:0; width:100%; height:100%; z-index:-1; pointer-events:none; display:block; }

/* subtle page base color remains; canvas will draw the animated content */
body { background: linear-gradient(180deg, #0f0610 0%, #0b0410 100%); }

@media (prefers-reduced-motion: reduce) {
  #bgCanvas { opacity:0.95; }
}

/* App container */
.app { width:340px; }

/* Greeting */
.greeting { text-align:center; font-size:20px; font-weight:600; padding:14px 22px; border-radius:24px; background:linear-gradient(135deg,#ff9ad5,#ff4fa3); box-shadow:0 3px 10px rgba(255,79,163,0.3); margin-top:10px; margin-bottom:12px; opacity:0; transform:translateY(-28px); transition: all 0.45s ease; z-index:10;}
.greeting.show { opacity:1; transform:translateY(-20px); }
.greetingAlt { font-size:16px; font-weight:500; padding:10px 18px; margin-bottom:24px; background:linear-gradient(135deg,#ff8fcf,#ff3e9c); }

/* Buttons */
.buttonRow { display:flex; justify-content:center; gap:12px; margin-top:16px; }
.glassBtn { padding:6px 18px; border-radius:14px; background: var(--glass); border:1px solid var(--pink); color:var(--pink); box-shadow:0 0 12px rgba(255,79,163,0.5); cursor:pointer; transition: all 0.2s ease; animation: floatBtn 4s ease-in-out infinite alternate;}
.glassBtn:hover { transform: translateY(-2px); box-shadow:0 0 25px rgba(255,79,163,0.8); }
.glassBtn:active { transform: translateY(0); box-shadow:0 0 18px rgba(255,79,163,0.6); }
@keyframes floatBtn { 0%{transform:translateY(0);} 100%{transform:translateY(-4px);} }

/* Date Box */
.dateWrapper { display:flex; align-items:center; justify-content:center; gap:10px; overflow:visible; position:relative; z-index:1; }
.sideArrow { width:38px;height:38px;border-radius:50%;background:var(--glass); border:1px solid var(--pink); color:var(--pink); cursor:pointer; box-shadow:0 0 10px rgba(255,79,163,0.45); transition: transform 0.18s ease; animation: floatBtn 4s ease-in-out infinite alternate;}
.sideArrow:active { transform: scale(0.96); }
#dateBox { width:240px; aspect-ratio: 1/1; height:auto; border-radius:28px;background:var(--glass); backdrop-filter: blur(18px); border:1px solid rgba(255,79,163,0.2); position:relative; overflow:hidden; cursor:pointer;}
#dateBox.today { box-shadow:0 0 45px rgba(255,79,163,0.9); }
.dateGlow { box-shadow: 0 0 12px rgba(255,79,163,0.45), 0 0 24px rgba(255,79,163,0.3); filter: drop-shadow(0 0 12px rgba(255,79,163,0.35)); animation: glowPulse 6s ease-in-out infinite; }
#dateBox.today.dateGlow { box-shadow:0 0 55px rgba(255,79,163,1); }
@keyframes glowPulse { 0%{ box-shadow:0 0 10px rgba(255,79,163,0.35), 0 0 18px rgba(255,79,163,0.2);} 50%{ box-shadow:0 0 18px rgba(255,79,163,0.6), 0 0 32px rgba(255,79,163,0.35);} 100%{ box-shadow:0 0 10px rgba(255,79,163,0.35), 0 0 18px rgba(255,79,163,0.2);} }

/* Wave */
#progressSvg { position:absolute; bottom:0; width:100%; height:100%; z-index:2; pointer-events:none; }
#wavePath { fill:url(#waveGradient); shape-rendering:auto; }

/* Date Text */
.dateContent { position:relative; z-index:3; height:100%; display:flex; flex-direction:column; justify-content:center; align-items:center; }
#dateBig { font-size:26px; font-weight:700; text-shadow:0 0 18px var(--pink);}
#weekday { font-size:14px; opacity:0.85; }

/* Task View */
#taskView { margin-top:16px; background: rgba(20,20,20,0.85); border-radius:22px; padding:20px; border:1px solid rgba(255,79,163,0.25); box-shadow:0 0 24px rgba(255,79,163,0.28);}
.taskHeader{ font-size:20px; font-weight:600; text-align:center; margin-bottom:16px; text-shadow:0 0 12px rgba(255,79,163,0.4);}
#todoList { list-style:none; padding:0; margin-top:10px; }
#todoList li { display:flex; align-items:center; gap:10px; margin-bottom:12px; padding:10px; border-radius:14px; background:rgba(255,79,163,0.08); border:1px solid rgba(255,79,163,0.2); transition: transform 0.15s ease, box-shadow 0.15s ease;}
#todoList li:hover { transform: translateY(-2px); box-shadow:0 0 15px rgba(255,79,163,0.3); }
.todoTextWrap { flex:1; display:flex; flex-direction:column; gap:4px; }
.todoCheckbox { width:22px; height:22px; border-radius:6px; border:2px solid var(--pink); cursor:pointer; transition:transform 0.2s ease,box-shadow 0.2s ease; }
.todoCheckbox.checked { background: var(--pink); box-shadow:0 0 16px var(--pink); animation:checkPop 0.35s ease; }
@keyframes checkPop {0%{transform:scale(0.8);}60%{transform:scale(1.3);}100%{transform:scale(1);} }
.todoItemText{flex:1;}
.todoItemText.done{text-decoration:line-through; opacity:0.5;}
.deadlineText { font-size:12px; opacity:0.75; }
.deadlineText.overdue { color:#ff8bc7; text-shadow:0 0 10px rgba(255,79,163,0.7); }
.deadlineText.dueSoon { color:#ffd1e8; text-shadow:0 0 10px rgba(255,79,163,0.5); }
.iconBtn{background:var(--glass); border:1px solid var(--pink); color:var(--pink); border-radius:50%; width:28px; height:28px; cursor:pointer; font-size:14px; line-height:1; display:flex; align-items:center; justify-content:center;}
.iconBtn:active { transform: scale(0.95); }
#taskInput{width:100%; background:rgba(0,0,0,0.4); border:1px solid var(--pink); border-radius:14px; padding:10px; color:white;}
.inputRow{display:flex; gap:10px; margin-top:10px; align-items:center;}
.deadlineRow{display:flex; gap:10px; margin-top:8px; align-items:center;}
.deadlineField{position:relative; flex:1; min-width:0; width:100%; overflow:hidden; border-radius:14px;}
#deadlineInput{width:100%; background:rgba(0,0,0,0.4); border:1px solid var(--pink); border-radius:14px; padding:10px; color:transparent; caret-color:white;}
.deadlineField.filled #deadlineInput{color:white;}
#deadlineInput:focus{color:white;}
.deadlinePlaceholder{position:absolute; inset:0; display:flex; align-items:center; padding:0 12px; color:rgba(255,255,255,0.65); pointer-events:none; font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
.deadlineField.filled .deadlinePlaceholder{display:none;}
#deadlineInput::-webkit-calendar-picker-indicator{ filter: invert(1) hue-rotate(300deg) saturate(2); opacity:0.9; cursor:pointer; }
#addTask{width:42px; height:42px; border-radius:50%; background:var(--pink); font-size:26px; border:none; color:black;}
#addTask:active { transform: scale(0.96); }
#clearBtn{margin-top:12px; width:100%; background:rgba(255,79,163,0.2); border:1px solid var(--pink); color:var(--pink); border-radius:14px; padding:8px;}

/* Deadline View */
#deadlineView { margin-top:16px; background: rgba(20,20,20,0.85); border-radius:22px; padding:20px; border:1px solid rgba(255,79,163,0.25); box-shadow:0 0 24px rgba(255,79,163,0.28);}
#deadlineList { list-style:none; padding:0; margin-top:10px; }
#deadlineList li { display:grid; grid-template-columns:auto 1fr; gap:6px 10px; align-items:center; margin-bottom:12px; padding:10px; border-radius:14px; background:rgba(255,79,163,0.08); border:1px solid rgba(255,79,163,0.2); }
.deadlineRowLine { display:flex; justify-content:space-between; gap:10px; font-size:14px; opacity:0.85; width:100%; }
.deadlineTaskText { font-weight:600; }
.deadlineMeta { font-size:12px; opacity:0.75; grid-column:2; }
.deadlineBadge { font-size:11px; padding:2px 6px; border-radius:10px; border:1px solid rgba(255,79,163,0.4); color:var(--pink); }
.deadlineBadge.overdue { color:#ff8bc7; border-color:#ff8bc7; text-shadow:0 0 10px rgba(255,79,163,0.7); }
.deadlineBadge.dueSoon { color:#ffd1e8; border-color:#ffd1e8; text-shadow:0 0 10px rgba(255,79,163,0.5); }

/* Modal */
.modalOverlay { position:fixed; inset:0; background:rgba(0,0,0,0.55); display:flex; align-items:center; justify-content:center; z-index:50; backdrop-filter: blur(3px); }
.modalOverlay:not(.hidden) .modalCard { animation: modalIn 180ms ease; }
.modalOverlay.hidden .modalCard { animation: none; }
.modalCard { width:min(92vw, 360px); background:rgba(20,20,20,0.9); border-radius:18px; border:1px solid rgba(255,79,163,0.28); box-shadow:0 0 24px rgba(255,79,163,0.35); padding:16px; }
@keyframes modalIn { from { opacity:0; transform: translateY(8px) scale(0.98); } to { opacity:1; transform: translateY(0) scale(1); } }
.modalTitle { font-size:18px; font-weight:600; text-align:center; margin-bottom:12px; }
.modalBody { display:flex; flex-direction:column; gap:10px; }
.modalInput { width:100%; background:rgba(0,0,0,0.4); border:1px solid var(--pink); border-radius:14px; padding:10px; color:white; }
.modalActions { display:flex; justify-content:space-between; gap:10px; margin-top:14px; }

/* Update banner */
#updateBanner { position:relative; z-index:20; }

/* Month Grid */
.monthGrid { display:grid; grid-template-columns: repeat(7,1fr); gap:6px; margin-top:12px; }
.monthDayBox { position:relative; border-radius:12px; height:50px; display:flex; justify-content:center; align-items:center; cursor:pointer; font-weight:600; overflow:hidden; background:var(--glass); }
.monthDayBox svg { position:absolute; bottom:0; width:100%; height:100%; z-index:0; }
/* Tooltip */
.monthDayBox .tooltip { position: absolute; bottom:100%; left:50%; transform:translateX(-50%); padding:4px 8px; background:var(--pink); color:black; font-size:12px; border-radius:6px; white-space:nowrap; opacity:0; pointer-events:none; transition: opacity 0.2s ease; z-index:10; }
.monthDayBox:hover .tooltip { opacity:1; }

/* ===== Mobile Responsive ===== */
@media (max-width: 480px) {
  body { min-height:100svh; align-items:center; padding:12px 0; }
  .app { width:min(92vw, 380px); margin:0 auto; }
  #dateView { padding-top:12px; }
  .greeting { font-size: 16px; padding:10px 14px; margin:6px auto 14px; width:100%; max-width:360px; }
  .buttonRow { flex-wrap: wrap; gap: 8px; }
  .glassBtn { padding: 6px 12px; font-size: 13px; }
  .sideArrow { width:32px; height:32px; }
  .dateWrapper { justify-content:center; }
  #dateBox { width: min(70vw, 280px); aspect-ratio: 1/1; height:auto; border-radius:20px; margin:0 auto; }
  #dateBig { font-size:20px; }
  #weekday { font-size:12px; }
  .dateWrapper { gap:8px; }
  #taskView, #deadlineView { padding:14px; margin-top:12px; }
  .taskHeader { font-size:18px; margin-bottom:12px; }
  #todoList li { flex-direction: row; align-items:center; gap:8px; padding:10px; }
  .todoTextWrap { flex:1; }
  .todoCheckbox { width:20px; height:20px; }
  .iconBtn { width:26px; height:26px; }
  #todoList li .iconBtn { margin-left:2px; }
  #todoList li .iconBtn:last-child { margin-right:0; }
  .inputRow { gap:8px; }
  .deadlineRow { gap:8px; }
  #taskInput { padding:9px; font-size:14px; }
  #deadlineInput { padding:9px; font-size:14px; }
  #addTask { width:38px; height:38px; font-size:22px; }
  #clearBtn { padding:8px; }
  .monthGrid {
    grid-template-columns: repeat(7, 72px);
    gap: 6px;
    overflow-x: auto;
    padding-bottom: 8px;
  }
  .monthGrid::-webkit-scrollbar { height: 6px; }
  .monthGrid::-webkit-scrollbar-thumb { background: var(--pink); border-radius: 3px; }
  .monthGrid::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); }
  .monthDayBox { flex: 0 0 auto; height:48px; min-width:72px; font-size:13px; }
  .monthDayBox .tooltip { font-size:10px; padding:3px 6px; }
}

@media (prefers-reduced-motion: reduce) {
  .view { animation: none; }
  .glassBtn, .sideArrow { animation: none; }
  .dateGlow { animation: none; }
  body::before { animation: none; }
  .modalOverlay:not(.hidden) .modalCard { animation: none; }
}

@media (max-width: 480px) and (max-height: 760px) {
  #dateBox { width: min(74vw, 280px); aspect-ratio: 1/1; height:auto; }
  .buttonRow { gap:6px; margin-top:12px; }
  .greeting { margin:4px auto 10px; }
}

@media (max-width: 360px) {
  .app { width:94vw; }
  #dateBox { width: min(88vw, 300px); aspect-ratio: 1/1; height:auto; max-width:300px; }
  .glassBtn { padding: 5px 10px; font-size: 12px; }
  #dateBig { font-size:18px; }
  .deadlineRow { flex-direction: column; align-items:stretch; }
  #addTask { width:100%; border-radius:12px; }
}